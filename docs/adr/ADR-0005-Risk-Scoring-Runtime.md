ADR-0005: Risk Scoring & Runtime Reactions
Модель оценки рисков и реакций в реальном времени
Статус: Accepted
Дата: 29.12.2025
Связанные ADR:
•	ADR-0001: AISOC Core
•	ADR-0002: Policy & Trust Model
•	ADR-0003: Agent Lifecycle & Governance
•	ADR-0004: Audit & Explainability Model
Контекст: Multi-Agent AI System / Enterprise & Regulated Environments
Владелец решения: Architecture / Security / Operations
________________________________________
1. Контекст и проблема
Агентная система выполняет действия в runtime, где:
•	риск формируется динамически (контекст, данные, пользователь, агент);
•	статических правил недостаточно;
•	решения должны приниматься до выполнения действия, а не постфактум;
•	реакции на инциденты должны быть автоматическими и предсказуемыми.
Проблема:
Без формализованной модели risk scoring невозможно:
•	различать допустимые и опасные действия в runtime;
•	реагировать пропорционально риску;
•	масштабировать систему без роста числа инцидентов;
•	доказать обоснованность блокировок и деградаций.
________________________________________
2. Принятое архитектурное решение
Вводится Risk Scoring & Runtime Reaction Model, где:
•	каждый запрос агента получает оценку риска;
•	оценка риска используется до принятия решения;
•	реакции на риск стандартизированы и управляемы;
•	AISOC является единственной точкой применения реакций.
Risk Scoring дополняет, но не заменяет Policy & Trust Model.
________________________________________
3. Источники сигнала риска
Оценка риска формируется из совокупности факторов:
3.1 Контекст агента
•	уровень доверия;
•	статус lifecycle (Active / Restricted);
•	история инцидентов.
3.2 Контекст запроса
•	тип действия (read / write / call);
•	тип данных (Public → Regulated);
•	направление (internal → external).
3.3 Поведенческие признаки
•	отклонение от типичных паттернов;
•	попытки обхода ограничений;
•	признаки prompt injection / jailbreak.
3.4 Внешние сигналы
•	данные Risk Analyzer;
•	threat intelligence;
•	региональные ограничения.
________________________________________
4. Модель оценки риска (Risk Score)
Риск выражается нормализованным числовым показателем
(например, 0–100) или категориально:
Уровень	Описание
Low	Допустимое поведение
Medium	Пограничное
High	Потенциально опасное
Critical	Недопустимое
Метод расчёта:
•	детерминированный;
•	воспроизводимый;
•	не основан на «мнениях» LLM;
•	полностью объясним.
________________________________________
5. Runtime Decision Flow
Последовательность принятия решения:
1.	Агент инициирует действие
2.	AISOC перехватывает запрос
3.	Проверка политики и доверия
4.	Расчёт Risk Score
5.	Выбор реакции
6.	Исполнение / блокировка
7.	Аудит и explainability
________________________________________
6. Модель реакций (Runtime Reactions)
Реакции стандартизированы и пропорциональны риску.
Risk Level	Реакция
Low	Allow
Medium	Allow + Monitor
High	Degrade / Partial Deny
Critical	Block / Kill-switch
Возможные реакции:
•	Allow — выполнение без ограничений;
•	Monitor — усиленное логирование;
•	Degrade — урезанный ответ, masking, rate limit;
•	Escalate — уведомление оператора;
•	Block — отказ в выполнении;
•	Kill-switch — изоляция агента.
________________________________________
7. Автоматизация и ограничения
Разрешено автоматически:
•	повышение уровня риска;
•	деградация возможностей;
•	временные блокировки;
•	изоляция агента при Critical.
Запрещено автоматически:
•	снижение уровня риска;
•	расширение доступа;
•	повышение доверия агента;
•	обход политики.
Любая автоматическая реакция:
•	логируется;
•	объяснима;
•	обратима (кроме Retired).
________________________________________
8. Взаимодействие с другими контурами
Контур	Роль
AISOC	Применение решений и реакций
Policy Engine	Базовые правила допустимости
Risk Analyzer	Поставщик сигналов
Audit Layer	Фиксация причин и действий
Agent Lifecycle	Изменение статуса агента
AITeacher	Анализ паттернов атак
________________________________________
9. Explainability риск-решений
Каждая реакция сопровождается объяснением:
•	текущий Risk Score;
•	факторы риска;
•	применённая политика;
•	выбранная реакция;
•	ссылка на аудит-запись.
Пример:
«Запрос заблокирован: Risk Score = 87 (High).
Причины: попытка доступа к Sensitive Data агентом T1, паттерн prompt injection.
Применена реакция Block согласно Policy P-07.»
________________________________________
10. Нормативное соответствие
Модель соответствует:
•	ISO/IEC 27001 (risk management);
•	NIST AI RMF (monitoring, response);
•	ISO/IEC 23894 (AI risk);
•	EU AI Act (runtime safeguards);
•	SOC 2 (incident response).
________________________________________
11. Последствия принятого решения
Плюсы:
•	пропорциональные реакции на риск;
•	снижение ложных блокировок;
•	масштабируемость;
•	объяснимость runtime-решений.
Минусы:
•	усложнение runtime-потока;
•	необходимость настройки порогов риска;
•	требования к наблюдаемости.
________________________________________
12. Итоговое решение
Risk Scoring и Runtime Reactions превращают контроль
из статичного запрета в управляемый механизм адаптивной защиты.
Без них AISOC реагирует “всё или ничего”,
с ними — пропорционально и объяснимо.
